# Linux实操篇-5

## Linux磁盘分区，挂载

#### 磁盘分区的介绍

###### 分区方式：

+ mbr分区

  最多支持四个主分区

  系统只能安装在主分区

  扩展分区要占一个主分区

  mbr最大只支持2TB，但是拥有最好的兼容性

+ gtp分区

  支持无线多个主分区（但是操作系统可能会限制，比如Windows下最多128个分区）

  最大支持18EB的最大容量（EB = 1024PB， PB = 1024TB）

  Windows7 64位后支持gtp

经典的Windows下磁盘分区

| 主分区 Primary partition | 逻辑分区 Logical partition | 逻辑分区 Logical partition | 逻辑分区 Logical partition |
| ------------------------ | -------------------------- | -------------------------- | -------------------------- |

#### Linux分区

###### 原理介绍

1. Linux来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构, Linux中每个分区都是用来组成整个文件系统的一部分。
2. Linux采用了一种叫“载入”的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。

> 示意图

![image-20210807102719091](C:\Users\LENOVO\AppData\Roaming\Typora\typora-user-images\image-20210807102719091.png)

###### 硬盘说明

1. Linux硬盘分IDE硬盘和SCSI硬盘，目前基本上是SCSI硬盘
2. 对于IDE硬盘，驱动器标识符为“hdx~”,其中“hd”表明分区所在设备的类型，这里是指IDE硬盘了。“x”为盘号（a为基本盘，b为基本从属盘，c为辅助主盘，d为辅助从属盘）,“ ~ ”代表分区，前四个分区用数字1到4表示，它们是主分区或扩展分区，从5开始就是逻辑分区。例，hda3表示为第一个IDE硬盘上的第三个主分区或扩展分区,hdb2表示为第二个IDE硬盘上的第二个主分区或扩展分区。
3. 对于SCSI硬盘则标识为“sdx~”，SCSI硬盘是用“sd”来表示分区所在设备的类型的，其余则和IDE硬盘的表示方法一样。

`lsblk -f`查看系统的分区和挂载的情况

![image-20210807103512916](C:\Users\LENOVO\AppData\Roaming\Typora\typora-user-images\image-20210807103512916.png)

#### 挂载的经典案例

给Linux系统增加一块硬盘，并且挂载到/home/newdisk

1. 虚拟机添加硬盘

2. 分区 `fdisk /dev/sdb`

3. 格式化 `mkfs -t ext4 /dev/sdb1`

4. 挂载 

   先创建一个 /home/newdisk，挂载 `mount dev/sdb1 /home/newdisk`

5. 设置可以自动挂载

   永久挂载，当重启系统时，仍然可以挂载到/home/newdisk

   vim /etc/fstab


#### 磁盘情况查询

###### 查询系统整体磁盘的使用情况

基本语法： `df -h`

###### 查询指定目录的磁盘占用情况

基本语法：`du -h /目录`

-s指定目录占用大小汇总
-h 带计量单位
-a 含文件
--max-depth=1 子目录深度
-c 列出明细的同时，增加汇总值

##### 工作使用指令

###### 统计/home/下文件的个数

`ls -l /home | grep "-" | wc -l`

###### 统计/home/下目录的个数

`ls -l /home | grep "^d" | wc -l`

###### 统计home及home子目录下的文件个数（包括子文件夹里面的）

`ls -lR /home | grep "-" | wc -l`

###### 以树状结构显示文件内容

使用 `tree`指令

> 当需要使用某些指令而没有的时候，可以使用 `yum install 指令 `  实现

