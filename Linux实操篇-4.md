# Linux实操篇-4

## 组管理和权限管理

### Linux组的基本介绍

在linux中的每个用户必须属于一个组，不能独立于组外。在linux中每个文件有所有者、所在组、其它组的概念。

1. 所有者
2. 所在组
3. 其它组
4. 改变用户所在的组

### 文件/目录所有者

一般为文件的创建者,谁创建了该文件，就自然的成为该文件的所有者。

#### 查看文件的所有者

指令： ***ls - ahl***

#### 改变文件所有者

指令：***chown 用户名 文件名***

### 组的创建

基本指令：***groupadd 【组名】***

#### 修改文件所在的组

当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组。
查看文件/目录所在组

+ 基本指令
  ***ls –ahl***

+ 基本指令
  ***chgrp 组名 文件名***

其他组：除了文件的所有者和所在组的用户之外，系统的其他用户都是文件的其他组

#### 改变用户的所在组

在添加用户时，可以指定将该用户添加到哪个组中，同样的用root的管理权限可以改变某个用户所在的组。

基本指令：

***usermod -g 【组名】 【用户名】***

***usermod -d 【目录名】 【用户名】***

### 权限的基本介绍

例子：`-rw-r--r-- 1 tom police 6 3月 18:19:24 ok.txt`

![image-20210729085634863](C:\Users\LENOVO\AppData\Roaming\Typora\typora-user-images\image-20210729085634863.png)

### rwx权限详解

#### rwx作用到文件

1) [ r ]代表可读(read): 可以读取,查看
2) [ w ]代表可写(write): 可以修改,但是不代表可以删除该文件,删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件.
3) [ x ]代表可执行(execute):可以被执行

#### rwx作用到目录

1) [ r ]代表可读(read): 可以读取，ls查看目录内容
2) [ w ]代表可写(write): 可以修改,目录内创建+删除+重命名目录
3) [ x ]代表可执行(execute):可以进入该目录

#### 实际案例

-rwxrw-r--1 root root 1213 Feb 2 09:39 abc
10个字符确定不同用户能对文件干什么
第一个字符代表文件类型：文件(-),目录(d),链接(l)
其余字符每3个一组(rwx) 读(r) 写(w) 执行(x)
第一组rwx : 文件拥有者的权限是读、写和执行
第二组rw-: 与文件拥有者同一组的用户的权限是读、写但不能执行
第三组r--: 不与文件拥有者同组的其他用户的权限是读不能写和执行

1文件：硬连接数或目录：子目录数
root 用户
root 组
1213 文件大小(字节)，如果是文件夹，显示4096字节
Feb 2 09:39 最后修改日期
abc 文件名

### 修改权限：-chmod

通过chmod指令，可以修改文件或者目录的权限。

#### 第一种方式：+ 、-、= 变更权限

u:所有者g:所有组o:其他人a:所有人(u、g、o的总和)

**可用数字表示为: r=4,w=2,x=1 因此rwx=4+2+1=7**

1) ***chmod u=rwx,g=rx,o=x 文件目录名***
2) chmod o+w 文件目录名
3) chmod a-x 文件目录名

#### 第二种方式：通过数字变更权限

chmod u=rwx,g=rx,o=x 文件目录名
相当于chmod 751 文件目录名

### 修改文件所有者-chown

chown newowner file 改变文件的所有者
chown newowner:newgroup file 改变用户的所有者和所有组
-R 如果是目录则使其下所有子文件或目录递归生效

### 修改文件所在组-chgrp

基本介绍

***chgrp newgroup file 改变文件的所有组***

## 定时任务调度

### cronb任务调度

crontab 进行定时任务的设置

任务调度：是指系统在某个时间执行的特定的命令或程序。
任务调度分类：

1. 系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等
2. 个别用户工作：个别用户可能希望执行某些程序，比如对mysql数据库的备份。

基本语法

***crontab 【选项】***

| 常用选项 | 功能                          |
| -------- | ----------------------------- |
| -e       | 编辑crontab定时任务           |
| -l       | 查询crontab任务               |
| -r       | 删除当前用户所有的crontab任务 |

+ 如果只是简单的任务，可以不用写脚本，直接再crontab中加入任务即可
+ 对于比较复杂的任务，需要写脚本（shell编程）

###### 快速入门

设置任务调度文件：/etc/crontab
设置个人任务调度。执行crontab –e命令。
接着输入任务到调度文件如：*/1 * * * * ls –l /etc/ > /tmp/to.txt
意思说每小时的每分钟执行ls –l /etc/ > /tmp/to.txt命令

###### 参数细节说明

| 项目      | 含义                 | 范围                    |
| --------- | -------------------- | ----------------------- |
| 第一个“*” | 一小时中的第几分钟   | 0-59                    |
| 第二个“*” | 一天当中的第几个小时 | 0-23                    |
| 第三个“*” | 一个月当中的第几天   | 1-31                    |
| 第四个“*” | 一年当中的第几个月   | 1-12                    |
| 第五个“*” | 一周当中的星期几     | 0-7（0和7都代表星期天） |

###### 特殊符号的说明

| 特殊符号 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思。 |
| ，       | 代表不连续的时间。比如“08,12,16***命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令 |
| -        | 代表连续的时间范围。比如“05**1-6命令”，代表在周一到周六的凌晨5点0分执行命令 |
| */n      | 代表每隔多久执行一次。比如“* /10 * * * *命令”，代表每隔10分钟就执行一遍命令 |

